<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Utilities used in the integration tests of this crate."><title>vulkan_layer::test_utils - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-47e7ab555ef2818a.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="vulkan_layer" data-themes="" data-resource-suffix="" data-rustdoc-version="1.74.0-nightly (ef85656a1 2023-08-21)" data-channel="nightly" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-b2d31d2efc7e9b67.css" data-theme-dark-css="dark-3388a2fb2ef8066b.css" data-theme-ayu-css="ayu-8c3c66a6cf12cb2f.css" ><script src="../../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-b2d31d2efc7e9b67.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-3388a2fb2ef8066b.css"><link rel="stylesheet" href="../../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../vulkan_layer/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../vulkan_layer/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module test_utils</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">vulkan_layer</a>::<wbr><a class="mod" href="#">test_utils</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/vulkan_layer/test_utils.rs.html#15-517">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>_test</code></strong> only.</div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Utilities used in the integration tests of this crate.</p>
<p>The Vulkan layer essentially provides a bunch of function pointers to the loader. To mock
multiple layers in the same process, it is required to use different types so different
function pointers will be generated. To avoid extremely long compile time, we shouldn’t create
a new layer type for every test case. Instead we run test cases in different processes, and
share the same layer type as possible. If a test case needs multiple layers at the same time,
multiple layer types should be used.</p>
<p>Follow the following steps to write a unit test:</p>
<ol>
<li>Use <a href="struct.TestGlobal.html#method.builder" title="associated function vulkan_layer::test_utils::TestGlobal::builder"><code>TestGlobal::builder</code></a> to construct the static resources needed to mock one layer. Mocks
to static methods can be set with different builder functions.</li>
<li>Call <a href="struct.TestGlobal.html#method.create_context" title="method vulkan_layer::test_utils::TestGlobal::create_context"><code>TestGlobal::create_context</code></a> to set up the scope for expections.</li>
<li>Use <a href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer"><code>TestLayer</code></a> as a layer implementation.</li>
</ol>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="__mock_MockDrop/index.html" title="mod vulkan_layer::test_utils::__mock_MockDrop">__mock_MockDrop</a></div></li><li><div class="item-name"><a class="mod" href="__mock_MockDrop_Drop/index.html" title="mod vulkan_layer::test_utils::__mock_MockDrop_Drop">__mock_MockDrop_Drop</a></div></li><li><div class="item-name"><a class="mod" href="__mock_MockTestLayer/index.html" title="mod vulkan_layer::test_utils::__mock_MockTestLayer">__mock_MockTestLayer</a></div></li><li><div class="item-name"><a class="mod" href="__mock_MockTestLayer_TestLayerMock/index.html" title="mod vulkan_layer::test_utils::__mock_MockTestLayer_TestLayerMock">__mock_MockTestLayer_TestLayerMock</a></div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ArcDel.html" title="struct vulkan_layer::test_utils::ArcDel">ArcDel</a></div><div class="desc docblock-short">A thread-safe reference-counting pointer, but with a custom deleter.</div></li><li><div class="item-name"><a class="struct" href="struct.Del.html" title="struct vulkan_layer::test_utils::Del">Del</a></div><div class="desc docblock-short">A wrapper for T but with a user defined deleter. ‘Del’ stands for ‘deleter’.</div></li><li><div class="item-name"><a class="struct" href="struct.MockDeviceInfo.html" title="struct vulkan_layer::test_utils::MockDeviceInfo">MockDeviceInfo</a></div><div class="desc docblock-short">A mock struct that implements the <a href="../trait.DeviceInfo.html" title="trait vulkan_layer::DeviceInfo"><code>DeviceInfo</code></a> trait.</div></li><li><div class="item-name"><a class="struct" href="struct.MockDrop.html" title="struct vulkan_layer::test_utils::MockDrop">MockDrop</a></div></li><li><div class="item-name"><a class="struct" href="struct.MockGlobalHooksInfo.html" title="struct vulkan_layer::test_utils::MockGlobalHooksInfo">MockGlobalHooksInfo</a></div><div class="desc docblock-short">A mock struct that implements the <a href="../trait.GlobalHooksInfo.html" title="trait vulkan_layer::GlobalHooksInfo"><code>GlobalHooksInfo</code></a> trait.</div></li><li><div class="item-name"><a class="struct" href="struct.MockInstanceInfo.html" title="struct vulkan_layer::test_utils::MockInstanceInfo">MockInstanceInfo</a></div><div class="desc docblock-short">A mock struct that implements the <a href="../trait.InstanceInfo.html" title="trait vulkan_layer::InstanceInfo"><code>InstanceInfo</code></a> trait.</div></li><li><div class="item-name"><a class="struct" href="struct.MockTestLayer.html" title="struct vulkan_layer::test_utils::MockTestLayer">MockTestLayer</a></div></li><li><div class="item-name"><a class="struct" href="struct.Tag.html" title="struct vulkan_layer::test_utils::Tag">Tag</a></div><div class="desc docblock-short">Test layer tags to distinguish different <a href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer"><code>TestLayer</code></a>. Different <code>I</code> will result in different
types.</div></li><li><div class="item-name"><a class="struct" href="struct.TestGlobal.html" title="struct vulkan_layer::test_utils::TestGlobal">TestGlobal</a></div><div class="desc docblock-short">The container of the static resources related to <a href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer"><code>TestLayer&lt;T&gt;</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.TestGlobalBuilder.html" title="struct vulkan_layer::test_utils::TestGlobalBuilder">TestGlobalBuilder</a></div><div class="desc docblock-short">The builder for <a href="struct.TestGlobal.html" title="struct vulkan_layer::test_utils::TestGlobal"><code>TestGlobal</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer">TestLayer</a></div><div class="desc docblock-short">The mock for the <a href="../trait.Layer.html" title="trait vulkan_layer::Layer"><code>Layer</code></a> trait.</div></li><li><div class="item-name"><a class="struct" href="struct.VkLayerDeviceCreateInfo.html" title="struct vulkan_layer::test_utils::VkLayerDeviceCreateInfo">VkLayerDeviceCreateInfo</a></div><div class="desc docblock-short">Sub type of structure for instance and device loader ext of CreateInfo. Bindings for the C
<code>VkLayerDeviceCreateInfo</code> type defined in the <code>vk_layer.h</code> file.</div></li><li><div class="item-name"><a class="struct" href="struct.VkLayerFunction.html" title="struct vulkan_layer::test_utils::VkLayerFunction">VkLayerFunction</a><span class="stab portability" title="Available on Windows only">Windows</span></div><div class="desc docblock-short">Bindings for the C <code>VkLayerFunction</code> type defined in the <code>vk_layer.h</code> file.</div></li><li><div class="item-name"><a class="struct" href="struct.VkLayerInstanceCreateInfo.html" title="struct vulkan_layer::test_utils::VkLayerInstanceCreateInfo">VkLayerInstanceCreateInfo</a></div><div class="desc docblock-short">Sub type of structure for instance and device loader ext of CreateInfo.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.LayerManifestExt.html" title="trait vulkan_layer::test_utils::LayerManifestExt">LayerManifestExt</a></div><div class="desc docblock-short">A trait to provide an extra meaningful constructor for <a href="../struct.LayerManifest.html" title="struct vulkan_layer::LayerManifest"><code>LayerManifest</code></a>.</div></li><li><div class="item-name"><a class="trait" href="trait.TestLayerMock.html" title="trait vulkan_layer::test_utils::TestLayerMock">TestLayerMock</a></div><div class="desc docblock-short">A set of interfaces that the integration tests are interested to mock.</div></li><li><div class="item-name"><a class="trait" href="trait.TestLayerTag.html" title="trait vulkan_layer::test_utils::TestLayerTag">TestLayerTag</a></div><div class="desc docblock-short">A trait used to include all possible <a href="struct.Tag.html" title="struct vulkan_layer::test_utils::Tag"><code>Tag&lt;I&gt;</code></a>.</div></li></ul><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.VkLayerDeviceLink.html" title="type vulkan_layer::test_utils::VkLayerDeviceLink">VkLayerDeviceLink</a></div><div class="desc docblock-short">A list node that contains the next entity’s <code>vkGetInstanceProcAddr</code> and
<code>vkGetDeviceProcAddr</code> used by a layer. One possible payload of <a href="struct.VkLayerDeviceCreateInfo.html" title="struct vulkan_layer::test_utils::VkLayerDeviceCreateInfo"><code>VkLayerDeviceCreateInfo</code></a></div></li></ul></section></div></main></body></html>