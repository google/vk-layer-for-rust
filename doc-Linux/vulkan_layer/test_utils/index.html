<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Utilities used in the integration tests of this crate."><title>vulkan_layer::test_utils - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-84e720fa.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="vulkan_layer" data-themes="" data-resource-suffix="" data-rustdoc-version="1.89.0-nightly (2805e1dc4 2025-05-26)" data-channel="nightly" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../../static.files/storage-4e99c027.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-fd3af306.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../vulkan_layer/index.html">vulkan_<wbr>layer</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module test_<wbr>utils</a></h2><h3><a href="#modules">Module Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate vulkan_<wbr>layer</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">vulkan_layer</a></div><h1>Module <span>test_utils</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/vulkan_layer/test_utils.rs.html#15-517">Source</a> </span></div><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>_test</code></strong> only.</div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Utilities used in the integration tests of this crate.</p>
<p>The Vulkan layer essentially provides a bunch of function pointers to the loader. To mock
multiple layers in the same process, it is required to use different types so different
function pointers will be generated. To avoid extremely long compile time, we shouldn’t create
a new layer type for every test case. Instead we run test cases in different processes, and
share the same layer type as possible. If a test case needs multiple layers at the same time,
multiple layer types should be used.</p>
<p>Follow the following steps to write a unit test:</p>
<ol>
<li>Use <a href="struct.TestGlobal.html#method.builder" title="associated function vulkan_layer::test_utils::TestGlobal::builder"><code>TestGlobal::builder</code></a> to construct the static resources needed to mock one layer. Mocks
to static methods can be set with different builder functions.</li>
<li>Call <a href="struct.TestGlobal.html#method.create_context" title="method vulkan_layer::test_utils::TestGlobal::create_context"><code>TestGlobal::create_context</code></a> to set up the scope for expectations.</li>
<li>Use <a href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer"><code>TestLayer</code></a> as a layer implementation.</li>
</ol>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="__mock_MockDrop/index.html" title="mod vulkan_layer::test_utils::__mock_MockDrop">__<wbr>mock_<wbr>Mock<wbr>Drop</a></dt><dt><a class="mod" href="__mock_MockDrop_Drop/index.html" title="mod vulkan_layer::test_utils::__mock_MockDrop_Drop">__<wbr>mock_<wbr>Mock<wbr>Drop_<wbr>Drop</a></dt><dt><a class="mod" href="__mock_MockTestLayer/index.html" title="mod vulkan_layer::test_utils::__mock_MockTestLayer">__<wbr>mock_<wbr>Mock<wbr>Test<wbr>Layer</a></dt><dt><a class="mod" href="__mock_MockTestLayer_TestLayerMock/index.html" title="mod vulkan_layer::test_utils::__mock_MockTestLayer_TestLayerMock">__<wbr>mock_<wbr>Mock<wbr>Test<wbr>Layer_<wbr>Test<wbr>Layer<wbr>Mock</a></dt></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.ArcDel.html" title="struct vulkan_layer::test_utils::ArcDel">ArcDel</a></dt><dd>A thread-safe reference-counting pointer, but with a custom deleter.</dd><dt><a class="struct" href="struct.Del.html" title="struct vulkan_layer::test_utils::Del">Del</a></dt><dd>A wrapper for T but with a user defined deleter. ‘Del’ stands for ‘deleter’.</dd><dt><a class="struct" href="struct.MockDeviceInfo.html" title="struct vulkan_layer::test_utils::MockDeviceInfo">Mock<wbr>Device<wbr>Info</a></dt><dd>A mock struct that implements the <a href="../trait.DeviceInfo.html" title="trait vulkan_layer::DeviceInfo"><code>DeviceInfo</code></a> trait.</dd><dt><a class="struct" href="struct.MockDrop.html" title="struct vulkan_layer::test_utils::MockDrop">Mock<wbr>Drop</a></dt><dt><a class="struct" href="struct.MockGlobalHooksInfo.html" title="struct vulkan_layer::test_utils::MockGlobalHooksInfo">Mock<wbr>Global<wbr>Hooks<wbr>Info</a></dt><dd>A mock struct that implements the <a href="../trait.GlobalHooksInfo.html" title="trait vulkan_layer::GlobalHooksInfo"><code>GlobalHooksInfo</code></a> trait.</dd><dt><a class="struct" href="struct.MockInstanceInfo.html" title="struct vulkan_layer::test_utils::MockInstanceInfo">Mock<wbr>Instance<wbr>Info</a></dt><dd>A mock struct that implements the <a href="../trait.InstanceInfo.html" title="trait vulkan_layer::InstanceInfo"><code>InstanceInfo</code></a> trait.</dd><dt><a class="struct" href="struct.MockTestLayer.html" title="struct vulkan_layer::test_utils::MockTestLayer">Mock<wbr>Test<wbr>Layer</a></dt><dt><a class="struct" href="struct.Tag.html" title="struct vulkan_layer::test_utils::Tag">Tag</a></dt><dd>Test layer tags to distinguish different <a href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer"><code>TestLayer</code></a>. Different <code>I</code> will result in different
types.</dd><dt><a class="struct" href="struct.TestGlobal.html" title="struct vulkan_layer::test_utils::TestGlobal">Test<wbr>Global</a></dt><dd>The container of the static resources related to <a href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer"><code>TestLayer&lt;T&gt;</code></a>.</dd><dt><a class="struct" href="struct.TestGlobalBuilder.html" title="struct vulkan_layer::test_utils::TestGlobalBuilder">Test<wbr>Global<wbr>Builder</a></dt><dd>The builder for <a href="struct.TestGlobal.html" title="struct vulkan_layer::test_utils::TestGlobal"><code>TestGlobal</code></a>.</dd><dt><a class="struct" href="struct.TestLayer.html" title="struct vulkan_layer::test_utils::TestLayer">Test<wbr>Layer</a></dt><dd>The mock for the <a href="../trait.Layer.html" title="trait vulkan_layer::Layer"><code>Layer</code></a> trait.</dd><dt><a class="struct" href="struct.VkLayerDeviceCreateInfo.html" title="struct vulkan_layer::test_utils::VkLayerDeviceCreateInfo">VkLayer<wbr>Device<wbr>Create<wbr>Info</a></dt><dd>Sub type of structure for instance and device loader ext of CreateInfo. Bindings for the C
<code>VkLayerDeviceCreateInfo</code> type defined in the <code>vk_layer.h</code> file.</dd><dt><a class="struct" href="struct.VkLayerFunction.html" title="struct vulkan_layer::test_utils::VkLayerFunction">VkLayer<wbr>Function</a><wbr><span class="stab portability" title="Available on Unix only">Unix</span></dt><dd>Bindings for the C <code>VkLayerFunction</code> type defined in the <code>vk_layer.h</code> file.</dd><dt><a class="struct" href="struct.VkLayerInstanceCreateInfo.html" title="struct vulkan_layer::test_utils::VkLayerInstanceCreateInfo">VkLayer<wbr>Instance<wbr>Create<wbr>Info</a></dt><dd>Sub type of structure for instance and device loader ext of CreateInfo.</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.LayerManifestExt.html" title="trait vulkan_layer::test_utils::LayerManifestExt">Layer<wbr>Manifest<wbr>Ext</a></dt><dd>A trait to provide an extra meaningful constructor for <a href="../struct.LayerManifest.html" title="struct vulkan_layer::LayerManifest"><code>LayerManifest</code></a>.</dd><dt><a class="trait" href="trait.TestLayerMock.html" title="trait vulkan_layer::test_utils::TestLayerMock">Test<wbr>Layer<wbr>Mock</a></dt><dd>A set of interfaces that the integration tests are interested to mock.</dd><dt><a class="trait" href="trait.TestLayerTag.html" title="trait vulkan_layer::test_utils::TestLayerTag">Test<wbr>Layer<wbr>Tag</a></dt><dd>A trait used to include all possible <a href="struct.Tag.html" title="struct vulkan_layer::test_utils::Tag"><code>Tag&lt;I&gt;</code></a>.</dd></dl><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><dl class="item-table"><dt><a class="type" href="type.VkLayerDeviceLink.html" title="type vulkan_layer::test_utils::VkLayerDeviceLink">VkLayer<wbr>Device<wbr>Link</a></dt><dd>A list node that contains the next entity’s <code>vkGetInstanceProcAddr</code> and
<code>vkGetDeviceProcAddr</code> used by a layer. One possible payload of <a href="struct.VkLayerDeviceCreateInfo.html" title="struct vulkan_layer::test_utils::VkLayerDeviceCreateInfo"><code>VkLayerDeviceCreateInfo</code></a></dd></dl></section></div></main></body></html>